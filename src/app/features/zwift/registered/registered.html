<div class="p-4">

  @if (loading()) {

    <div class="space-y-3">
      <div class="skeleton h-6 w-1/3"></div>
      <div class="skeleton h-6 w-2/3"></div>
      <div class="skeleton h-6 w-full"></div>
    </div>

  } @else if (error()) {

    <div role="alert" class="alert alert-soft alert-error">
      {{ error() }}
    </div>

  } @else {

    <div class="overflow-x-auto">
      <table class="table table-sm">
        <thead>
          <tr class="bg-base-200">
            <th class="sticky left-0 z-20">Rider</th>
            <th class="text-center">Cat</th>
            <th class="text-center">Phenotype</th>
            <th class="text-right">Weight</th>
            <th class="text-right">Height</th>
          </tr>
        </thead>

        <tbody>
        @for (r of datas(); let i = $index; track r.zwiftId) {

            <!-- Category separator -->
            @if (isNewCategory(i)) {
            <tr class="bg-base-300">
                <td colspan="5"
                    class="font-semibold text-sm uppercase tracking-wide py-2">
                Category {{ catNumber(r.tCat) }}
                </td>
            </tr>
            }

            <!-- Rider row -->
            <tr>

            <!-- Rider -->
            <td class="sticky left-0 bg-base-200 z-10">
                @if (r.flag) {
                <img
                    class="inline-block h-4 w-6 me-1"
                    [src]="'assets/flags/4x3/' + r.flag.toLowerCase() + '.svg'"
                />
                }

                <a
                class="font-medium hover:underline"
                [href]="'https://zwiftpower.com/profile.php?z=' + r.zwiftId"
                target="_blank"
                rel="noopener"
                >
                {{ r.racerName || ('Zwift #' + r.zwiftId) }}
                </a>

            <span
                class="ms-1 text-sm font-bold"
                [class.text-gray-400]="r.male"
                [class.text-pink-600]="!r.male"
            >
            {{ r.male ? '' : 'F' }}
            </span>
            </td>

            <!-- Category number -->
            <td class="text-center font-semibold">
                {{ catNumber(r.tCat) }}
            </td>

            <!-- Phenotype -->
            <td class="text-center">
                {{ r.phenotype }}
            </td>

            <!-- Weight -->
            <td class="text-right">
                {{ r.weight }}
                <span class="text-xs text-gray-500">kg</span>
            </td>

            <!-- Height -->
            <td class="text-right">
                {{ r.height }}
                <span class="text-xs text-gray-500">cm</span>
            </td>

            </tr>
        }
        </tbody>
      </table>
    </div>

  }

</div>
