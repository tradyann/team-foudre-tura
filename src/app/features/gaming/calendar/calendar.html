<div class="p-4">
  @if (loading()) {
    <!-- Skeleton loading -->
    <div class="flex gap-4">
      <div class="skeleton h-24 w-24 rounded"></div>
      <div class="flex-1 space-y-3">
        <div class="skeleton h-6 w-1/3"></div>
        <div class="skeleton h-4 w-1/2"></div>
        <div class="skeleton h-4 w-2/3"></div>
      </div>
    </div>
  } @else if (error()) {
    <div role="alert" class="alert alert-soft alert-error mt-2">
      <span>{{ error() }}</span>
    </div>
  } @else {

    <h2 class="text-xl font-bold mb-3">Upcoming & past Competitions</h2>

    <div class="overflow-x-auto">
      <table class="table table-sm">
        <thead>
          <tr class="bg-base-200 text-xs uppercase">
            <th>Competition</th>
            <th>Prestige</th>
            <th>Type</th>
            <th>Access</th>
            <th class="text-center" title="Stages">Stages</th>
            <th title="Prize Pool">Prize</th>
          </tr>
        </thead>

        <tbody>
          @for (t of results(); track t.competitionId) {
            <tr>
              <!-- Competition -->
              <td>
                <a class="font-medium hover:underline hover:text-primary" [routerLink]="['/game/competition', t.competitionId]">{{ t.competitionName }}</a>      
                @if (t.dateValidated) {
                  <div class="opacity-60">{{ t.fromDate | date: 'EEE, MMM d' }} - {{ t.toDate | date: 'EEE, MMM d' }}</div>
                } @else {
                  <div class="opacity-60 italic text-xs">Approximatively in {{ t.fromDate | date: 'MMMM y' }}</div>
                }
                
              </td>

              <!-- Prestige name -->
              <td>
                {{ t.prestigeName }}
                <div>
                  <span class="text-yellow-500">
                    @for (i of five.slice(0, t.stars); track i) { ★ }
                  </span>
                  <span class="text-gray-300">
                    @for (i of five.slice(t.stars, 5); track i) { ★ }
                  </span>
                </div>
              </td>

              <!-- Type -->
              <td>
                <span class="text-xs">
                  {{ t.typeCompetition }}
                </span>
              </td>

              <!-- Access (1=open, 2=premium, 3=private) -->
              <td>
                <span class="text-sm" [ngClass]="{'font-medium': t.eventClassName === 'Premium'}">
                  {{ t.eventClassName }}
                  @if ( t.eventClassName === 'Premium') {
                    ★
                  }
                </span>
              </td>

              <!-- Stages -->
              <td class="text-center">
                {{ t.stagesCount }}
              </td>

              <!-- Prize -->
              <td>
                <span class="font-semibold">{{ t.prizePool | currency:'$':'symbol':'1.0-0'}}</span>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    @if (results().length === 0) {
      <div class="mt-6 text-center text-sm opacity-70">No upcoming competitions.</div>
    }
  }
</div>
